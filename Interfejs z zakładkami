package kalkulator_ip;

import javax.swing.JTabbedPane;
import javax.swing.JTextField;
import javax.swing.JPanel;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JButton;
import javax.swing.JComponent;
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Font;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.ArrayList;
import java.util.List;

public class Kalkulator extends JPanel {
	/**
	 * 
	 */
	private static final long serialVersionUID = 1L;

	private JComponent panel1 = makePanel();
	private JComponent panel2 = makePanel();
	private JComponent panel3 = makePanel();
	public static JFrame frame = new JFrame("Kalkulator IP by: K. Cie\u017C & B. Cholewa");
	public Color kolor = Color.GRAY;

	// zakładka 1
	private static JTextField textField_Adres_Sieci_Pelne;
	private static JTextField textField_Liczba_Hostow_Pelne;
	// zakładka 2

	// zakładka3
	private static JTextField textField_Adres_Sieci;
	private static JTextField textField_Numer_Podsieci;
	private static JTextField textField_Liczba_Hostow1;

	private static JTextField textField_Procent_Wolnych;

	public Kalkulator() {
		super(new GridLayout(1, 1));

		JTabbedPane tabbedPane = new JTabbedPane();

		panel1.setPreferredSize(new Dimension(400, 300));// zakładka 1
		panel1.setBackground(kolor);
		tabbedPane.addTab("1.Podejście z pełnymi sieciami", null, panel1,
				"Sieci są możliwie pełne, nie ma wolnych adersów");
		panel1.setLayout(null);
		///////////////////////////////

		JLabel lblKalkulatorIp_pelne = new JLabel("Kalkulator IP - pełne sieci");
		lblKalkulatorIp_pelne.setFont(new Font("Tahoma", Font.BOLD, 18));
		lblKalkulatorIp_pelne.setBounds(10, 11, 250, 49);
		panel1.add(lblKalkulatorIp_pelne);

		JLabel lblPdajAdresSieci_pelne = new JLabel("Pdaj adres sieci: ");
		lblPdajAdresSieci_pelne.setBounds(10, 103, 102, 35);
		panel1.add(lblPdajAdresSieci_pelne);

		JLabel lblLiczbaHostw_pelne = new JLabel("Liczba host\u00F3w:");
		lblLiczbaHostw_pelne.setBounds(10, 136, 102, 28);
		panel1.add(lblLiczbaHostw_pelne);

		JButton btnOblicz_pelne = new JButton("Oblicz");
		btnOblicz_pelne.setBounds(10, 170, 89, 23);
		panel1.add(btnOblicz_pelne);
		btnOblicz_pelne.addActionListener(new PrzyciskListenerObliczPelne());
		// return btnOblicz;

		textField_Adres_Sieci_Pelne = new JTextField();
		textField_Adres_Sieci_Pelne.setBounds(113, 109, 136, 20);
		panel1.add(textField_Adres_Sieci_Pelne);
		textField_Adres_Sieci_Pelne.setColumns(10);

		textField_Liczba_Hostow_Pelne = new JTextField();
		textField_Liczba_Hostow_Pelne.setBounds(113, 140, 86, 20);
		panel1.add(textField_Liczba_Hostow_Pelne);
		textField_Liczba_Hostow_Pelne.setColumns(10);

		///////////////////////////////
		panel2.setPreferredSize(new Dimension(400, 300));// zakładka 1
		panel2.setBackground(kolor);
		tabbedPane.addTab("2.Podejście z wolnymi adresami", null, panel2, "Zostają wolne adresy w wyliczonej sieci ");
		panel2.setLayout(null);

		///////////////////////////////

		// Twój kod

		///////////////////////////////
		panel3.setPreferredSize(new Dimension(400, 300));// zakładka 1
		panel3.setBackground(kolor);
		tabbedPane.addTab("3.Podejście architekta", null, panel3, "Projektowanie sieci");
		panel3.setLayout(null);

		////////////////////////////////

		JLabel lblKalkulatorIp = new JLabel("Kalkulator IP - podejście architekta");
		lblKalkulatorIp.setFont(new Font("Tahoma", Font.BOLD, 18));
		lblKalkulatorIp.setBounds(10, 11, 350, 49);
		panel3.add(lblKalkulatorIp);

		JLabel lblPdajAdresSieci = new JLabel("Pdaj adres sieci: ");
		lblPdajAdresSieci.setBounds(10, 103, 102, 35);
		panel3.add(lblPdajAdresSieci);

		JLabel lblLiczbaPodsieci = new JLabel("Numer podsieci do zmiany:");
		lblLiczbaPodsieci.setBounds(10, 196, 200, 28);
		panel3.add(lblLiczbaPodsieci);

		JLabel lblLiczbaHostw = new JLabel("Liczba host\u00F3w:");
		lblLiczbaHostw.setBounds(10, 133, 102, 35);
		panel3.add(lblLiczbaHostw);

		JLabel lblProcent = new JLabel("Procent wolych adresów:");
		lblProcent.setBounds(10, 166, 145, 35);
		panel3.add(lblProcent);

		JButton btnOblicz = new JButton("Oblicz");
		btnOblicz.setBounds(10, 240, 89, 23);
		panel3.add(btnOblicz);
		btnOblicz.addActionListener(new PrzyciskListenerObliczArchitekt());

		JButton btnDodaj = new JButton("Dodaj hosty");
		btnDodaj.setBounds(150, 140, 150, 23);
		panel3.add(btnDodaj);
		btnDodaj.addActionListener(new PrzyciskListenerDodajArchitekt());

		JButton btnZmien = new JButton("Zmień");
		btnZmien.setBounds(265, 200, 80, 23);
		panel3.add(btnZmien);
		btnZmien.addActionListener(new PrzyciskListenerZmienArchitekt());
		// return btnOblicz;

		textField_Adres_Sieci = new JTextField();
		textField_Adres_Sieci.setBounds(113, 109, 136, 20);
		panel3.add(textField_Adres_Sieci);
		textField_Adres_Sieci.setColumns(10);

		textField_Numer_Podsieci = new JTextField();
		textField_Numer_Podsieci.setBounds(170, 202, 86, 20);
		panel3.add(textField_Numer_Podsieci);
		textField_Numer_Podsieci.setColumns(10);

		textField_Liczba_Hostow1 = new JTextField();
		textField_Liczba_Hostow1.setBounds(113, 140, 30, 20);
		panel3.add(textField_Liczba_Hostow1);
		textField_Liczba_Hostow1.setColumns(10);

		textField_Procent_Wolnych = new JTextField();
		textField_Procent_Wolnych.setBounds(170, 172, 75, 20);
		panel3.add(textField_Procent_Wolnych);
		textField_Procent_Wolnych.setColumns(10);

		////////////////////////////////

		// Add the tabbed pane to this panel.
		add(tabbedPane);

	}

	public static void main(String[] args) {

		javax.swing.SwingUtilities.invokeLater(new Runnable() {
			public void run() {
				GUI();
			}
		});
	}

	protected JComponent makePanel() {
		JPanel panel = new JPanel(false);

		panel.setLayout(new GridLayout(1, 1));

		return panel;
	}

	private static void GUI() {
		// Make sure we have nice window decorations.
		// JFrame.setDefaultLookAndFeelDecorated(true);

		frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		frame.setBounds(0, 0, 400, 300);
		frame.setLocationRelativeTo(null);
		frame.setResizable(false);

		// Create and set up the content pane.
		JComponent newContentPane = new Kalkulator();
		newContentPane.setOpaque(true); // content panes must be opaque
		frame.getContentPane().add(new Kalkulator(), BorderLayout.CENTER);

		// Display the window.
		frame.pack();
		frame.setVisible(true);
	}

	private class PrzyciskListenerObliczPelne implements ActionListener {

		public void actionPerformed(ActionEvent event) {

			// siec =
			// pobierzLiczbyZeStringa(textField_Adres_Sieci_Pelne.getText());
			// maska =
			// pobierzLiczbyZeStringa(textField_Maska_Sieci_Pelne.getText());

			// Pelne.Licz_hosty(Pelne.siec,liczba_hostow);

			Pelne p = new Pelne();
			p.hosty = Integer.parseInt(textField_Liczba_Hostow_Pelne.getText());
			// p.siec = pobierzLiczbyZeStringa("192.168.1.0");
			// p.Licz_hosty(p.siec = pobierzLiczbyZeStringa("192.168.1.2"));
			p.Licz_hosty(p.siec = pobierzLiczbyZeStringa(textField_Adres_Sieci_Pelne.getText()));

		}

	}

	private class PrzyciskListenerDodajArchitekt implements ActionListener {

		public void actionPerformed(ActionEvent event) {

			int hosty = Integer.parseInt(textField_Liczba_Hostow1.getText());

			Architekt.liczba_hostow_architekt.add(hosty);

			// Architektv2.liczba_hostow_architekt.add(hosty);
			// System.out.println(Architektv2.liczba_hostow_architekt);
		}
	}

	private class PrzyciskListenerObliczArchitekt implements ActionListener {

		public void actionPerformed(ActionEvent event) {

			int procet = Integer.parseInt(textField_Procent_Wolnych.getText());

			Architekt.Sortuj_liste_hostow();
			Architekt.adres = pobierzLiczbyZeStringa(textField_Adres_Sieci.getText());

			try {
				// Architekt_wynik.initialize();
				Architekt.initialize1();
				Architekt.Licz_hosty(Architekt.liczba_hostow_architekt, procet, 0, 0);
			} catch (IndexOutOfBoundsException e) {

			}

		}
	}

	private class PrzyciskListenerZmienArchitekt implements ActionListener {

		public void actionPerformed(ActionEvent event) {

			int hosty = Integer.parseInt(textField_Liczba_Hostow1.getText());
			int numer = Integer.parseInt(textField_Numer_Podsieci.getText()) - 1;
			int procet = Integer.parseInt(textField_Procent_Wolnych.getText());

			Architekt.liczba_hostow_architekt.set(numer, hosty);

			Architekt.Sortuj_liste_hostow();
			Architekt.adres = pobierzLiczbyZeStringa(textField_Adres_Sieci.getText());

			Architekt.frame2.setVisible(false);

			try {
				Architekt.initialize1();

				JLabel lbladres = new JLabel("Po zmaianach:");
				lbladres.setFont(new Font("Tahoma", Font.BOLD, 18));
				lbladres.setBounds(20, Architekt.y + 20, 250, 22);
				Architekt.panel.add(lbladres);
				Architekt.y += 40;

				Architekt.Licz_hosty(Architekt.liczba_hostow_architekt, procet, 0, 0);
			} catch (IndexOutOfBoundsException e) {

			}

		}
	}

	private static List<Integer> pobierzLiczbyZeStringa(String s) {
		List<Integer> l = new ArrayList<Integer>();
		char[] liczby = s.toCharArray();
		for (int i = 0; i < liczby.length; i++) {
			if (Character.isDigit(liczby[i])) {
				String num = "";
				while (i < liczby.length && Character.isDigit(liczby[i])) {
					num += liczby[i++];
				}
				l.add(Integer.parseInt(num));
			}
		}
		return l;
	}

}
